<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regional Analysis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #d9f1ff;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            max-width: 1200px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .controls {
            width: 30%;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .dropdown-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .dropdown-container {
            display: flex;
            flex-direction: column;
        }
        .image-preview-container {
            width: 65%;
            display: flex;
            justify-content: space-around;
            gap: 20px;
        }
        .image-container {
            width: 45%;
            text-align: center;
            position: relative;
        }
        .image-container img {
            width: 100%;
            max-height: 400px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .button-container button {
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #de85b8;
            color: #fff;
            cursor: pointer;
        }
        .button-container button:hover {
            background-color: #ff1493;
        }
        .hidden {
    display: none; /* Class to hide elements */
}
.enlarged {
    transform: scale(1.5); /* Scale up the images */
    transition: transform 0.3s ease; /* Smooth transition */
}
         /* Style for the homepage button */
        .homepage-button {
            position: fixed; /* Fixed position to stay at the top */
            top: 10px;
            left: 10px;
            background-color:#e6a8d7; /* Green */
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            z-index: 1000; /* Ensure it's on top of other elements */
        }


    </style>
</head>
<a href="http://127.0.0.1:5000/bac#" class="homepage-button">Go to Homepage</a>

<body>
   <div class="container">
    <div class="controls">
        <h2>Regional analysis</h2>

        <!-- Controls for Figure 1 -->
        <div class="dropdown-container">
            <span class="dropdown-label">Patient Category (Figure 1):</span>
            <select id="patient-category-1">
                <option value="LVO">LVO</option>
                <option value="ALL">ALL</option>
                <option value="NON_LVO">NON_LVO</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Parameter 1 (Figure 1):</span>
            <select id="value1-1">
                <option value="MTT">MTT</option>
                <option value="COV">COV</option>
                <option value="CTH">CTH</option>
                <option value="TTP">TTP</option>
                <option value="CBF">CBF</option>
                <option value="TMAX">TMAX</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Parameter 2 (Figure 1):</span>
            <select id="value2-1">
                <option value="MTT">MTT</option>
                <option value="COV">COV</option>
                <option value="CTH">CTH</CTH>
                <option value="TTP">TTP</option>
                <option value="CBF">CBF</CBF>
                <option value="TMAX">TMAX</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Dimensionality (Figure 1):</span>
            <select id="dimensionality-1">
                <option value="3D">3D</option>
                <option value="2D">2D</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Figure 1 Type:</span>
            <select id="figure-1-type">
                <option value="Recanalized">Recanalized</option>
                <option value="Non-Recanalized">Non-Recanalized</option>
            </select>
        </div>

        <!-- Controls for Figure 2 -->
        <div class="dropdown-container">
            <span class="dropdown-label">Patient Category (Figure 2):</span>
            <select id="patient-category-2">
                <option value="LVO">LVO</option>
                <option value="ALL">ALL</option>
                <option value="NON_LVO">NON_LVO</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Parameter 1 (Figure 2):</span>
            <select id="value1-2">
                <option value="MTT">MTT</option>
                <option value="COV">COV</option>
                <option value="CTH">CTH</CTH>
                <option value="TTP">TTP</option>
                <option value="CBF">CBF</CBF>
                <option value="TMAX">TMAX</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Parameter 2 (Figure 2):</span>
            <select id="value2-2">
                <option value="MTT">MTT</option>
                <option value="COV">COV</option>
                <option value="CTH">CTH</CTH>
                <option value="TTP">TTP</TTP>
                <option value="CBF">CBF</CBF>
                <option value="TMAX">TMAX</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Dimensionality (Figure 2):</span>
            <select id="dimensionality-2">
                <option value="3D">3D</option>
                <option value="2D">2D</option>
            </select>
        </div>
        <div class="dropdown-container">
            <span class="dropdown-label">Figure 2 Type:</span>
            <select id="figure-2-type">
                <option value="Recanalized">Recanalized</option>
                <option value="Non-Recanalized">Non-Recanalized</option>
            </select>
        </div>

        <div class="button-container">
            <button id="visualize-button">Visualize</button>
            <button id="enlarge-button">Enlarge Images</button>

        </div>
    </div>

    <div class="image-preview-container">
        <div class="image-container">
            <h3 id="image-1-title">Figure 1</h3>
            <img id="image-1" alt="Preview" style="display:block;">
        </div>
        <div class="image-container">
            <h3 id="image-2-title">Figure 2</h3>
            <img id="image-2" alt="Preview" style="display:block;">
        </div>
    </div>
</div>

<script>
    document.getElementById("enlarge-button").addEventListener("click", function() {



    // Hide the controls
    document.getElementById("controls").classList.add("hidden");

    // Enlarge both images
    document.getElementById("image-1").classList.add("enlarged");
    document.getElementById("image-2").classList.add("enlarged");
});

document.getElementById("visualize-button").addEventListener("click", function() {
    // Get values for Figure 1
    const patientCategory1 = document.getElementById("patient-category-1").value;
    const value1_1 = document.getElementById("value1-1").value;
    const value2_1 = document.getElementById("value2-1").value;
    const dimension1 = document.getElementById("dimensionality-1").value;
    const figure1Type = document.getElementById("figure-1-type").value;

    console.log(`Figure 1 - Patient Category: ${patientCategory1}, Value 1: ${value1_1}, Value 2: ${value2_1}, Dimension: ${dimension1}, Type: ${figure1Type}`);

    // Construct the title for Figure 1
    const title1 = `Figure 1: ${patientCategory1}, ${value1_1}, ${value2_1}, ${dimension1}, ${figure1Type}`;

    // Fetch image for Figure 1
    fetch(`/get_image?patient_category=${patientCategory1}&value1=${value1_1}&value2=${value2_1}&dimension=${dimension1}&figure_type=${figure1Type}`)
        .then(response => {
            if (response.ok) {
                return response.blob();
            }
            throw new Error('Image not found for Figure 1');
        })
        .then(imageBlob => {
            const imageObjectURL = URL.createObjectURL(imageBlob);
            const imageElement = document.getElementById("image-1");
            imageElement.src = imageObjectURL;

            // Set the title
            document.getElementById("image-1-title").textContent = title1;
        })
        .catch(error => {
            console.error(error);
            document.getElementById("image-1-title").textContent = "Image not found"; // Set title to "Image not found" on error
            document.getElementById("image-1").src = ""; // Clear the image
        });

    // Get values for Figure 2
    const patientCategory2 = document.getElementById("patient-category-2").value;
    const value1_2 = document.getElementById("value1-2").value;
    const value2_2 = document.getElementById("value2-2").value;
    const dimension2 = document.getElementById("dimensionality-2").value;
    const figure2Type = document.getElementById("figure-2-type").value;

    console.log(`Figure 2 - Patient Category: ${patientCategory2}, Value 1: ${value1_2}, Value 2: ${value2_2}, Dimension: ${dimension2}, Type: ${figure2Type}`);

    // Construct the title for Figure 2
    const title2 = `Figure 2: ${patientCategory2}, ${value1_2}, ${value2_2}, ${dimension2}, ${figure2Type}`;

    // Fetch image for Figure 2
    fetch(`/get_image?patient_category=${patientCategory2}&value1=${value1_2}&value2=${value2_2}&dimension=${dimension2}&figure_type=${figure2Type}`)
        .then(response => {
            if (response.ok) {
                return response.blob();
            }
            throw new Error('Image not found for Figure 2');
        })
        .then(imageBlob => {
            const imageObjectURL = URL.createObjectURL(imageBlob);
            const imageElement = document.getElementById("image-2");
            imageElement.src = imageObjectURL;

            // Set the title
            document.getElementById("image-2-title").textContent = title2;
        })
        .catch(error => {
            console.error(error);
            document.getElementById("image-2-title").textContent = "Image not found"; // Set title to "Image not found" on error
            document.getElementById("image-2").src = ""; // Clear the image
        });
});
</script>

</html>
